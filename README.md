# 深海牧场

## 任务背景

本子任务致力于处理海底2D重建图，通过计算机视觉等方法识别海底生物并计算丰度。本任务的母项目是一个多学科交叉研究项目，结合了计算机视觉、生态学、地理信息系统（GIS）、化学分析与生态建模技术。本研究的主要目标是量化甲烷喷发对海底生物群落的影响，并探索喷发规模与生物分布、物种多样性之间的关系。

### 数据来源

项目数据来源于深潜器的多视角摄像系统以及海水化学与微生物的垂直采样。我们收集了来自深潜器的以下视频数据：

- **前置摄像头**
- **尾端摄像头**
- **左右两个侧翼摄像头**

此外，还进行了竖直方向的海水化学与微生物数据采样，这些数据将用于分析甲烷喷发对不同海水层的化学影响和微生物分布。

## 项目目标

1. **海底景观重建**：根据多角度视频数据合成完整的海底二维图景，进行海底景观的复现，构建海底环境的整体视觉图。
2. **海底生物分布分析**：基于海底2D重建图，分析海底特定位置的生物数量和密度，探索海底不同生物群体在海底冷泉辐射区域的分布模式。
3. **甲烷喷发与生物分布关系分析**：量化甲烷喷发量与周围生物分布和密度的关系，并通过生态系统建模技术，预测甲烷喷发对生物分布的长期影响。
4. **海水化学与微生物分布分析**：基于海水采样数据，分析甲烷喷发对海水化学和微生物分布的影响，构建甲烷喷发影响范围的预测模型。

## 任务分配

### 1. 海底景观重建组

- **目标**：使用计算机视觉与图像处理技术，对来自不同视角的海底视频进行图像拼接和重构，合成完整的海底景观图。
- **技术要点**：目标检测、图像配准与拼接、三维建模、点云分析。
- **关键技术**：OpenCV, SIFT/SURF 特征匹配, 点云处理（PCL）。

### 2. 海底生物分布统计分析组（**当前任务**）

- **目标**：使用机器学习算法自动识别和统计海底特定区域内的生物种类和密度，并分析其时空分布特征。
- **技术要点**：目标检测、图像识别、数据标注与分类、统计分析。
- **关键技术**：，深度学习模型（如 YOLO, Mask R-CNN），图像标注工具（如 LabelMe），数据可视化（Matplotlib, Seaborn）。

### 3. 甲烷喷发与生物分布关系分析组

- **目标**：构建甲烷喷发对海洋生态系统中生物分布影响的模型，并量化甲烷喷发量与生物密度、种群数量之间的关系。
- **任务描述**：
  1. 通过分析甲烷喷发区域与非喷发区域的生物数量差异，探讨甲烷喷发对局部生态系统的直接影响。
  2. 构建甲烷喷发量与生物数量之间的关系模型，并进行时空预测。
  3. 探讨甲烷喷发量、频率对生物聚集模式的长期影响。
- **技术要点**：生态系统建模、物种分布模型（SDM）、广义线性模型（GLM）、时空分析、机器学习。
- **关键技术**：scikit-learn, statsmodels, PyGAM, PyKrige, GeoPandas。

### 4. 海水化学与微生物分布分析组

- **目标**：基于海水垂直采样数据，量化甲烷喷发对不同深度海水化学成分和微生物群落的影响，构建甲烷扩散模型。
- **技术要点**：空间数据处理、垂直采样数据分析、空间自相关与插值分析。
- **关键技术**：GeoPandas, Rasterio, PyProj, Kriging 插值（PyKrige）。

## 当前子任务：海底生物分布统计分析

### 任务说明

- 本子任务的目标是使用深度学习模型，统计海底特定区域内的生物种类和密度。
- 当前阶段主要聚焦于：
  1. 建立用于目标检测的海底生物基础数据集。
  2. 使用目标检测模型对海底2D重建图包含的生物进行数量统计和密度统计。
  3. 根据历史喷发数据，探索甲烷喷发量对物种分布的预测模型。

### 使用技术栈

- **生态系统建模与预测**：`yolo`，`scikit-learn`, `pyGAM`
- **数据处理**：`pandas`, `numpy`
- **数据分析与统计**：`scipy`, `statsmodels`
- **地理空间数据分析**：`GeoPandas`, `PyKrige`
- **可视化**：`matplotlib`, `seaborn`
- **数据增强**：`albumentations`
- **待更新**：

### 各文件夹和文件说明

- **`README.md`**：项目说明文件，包含项目背景、目标、技术细节和环境配置说明。
- **`references_list`**：保存相关的参考文献。
- **`yolov5/`**： 保存yolov5的pytorch文件
- **`yolov11/`**： 保存调用yolov11的python文件(主要基于ultralytics库)
- **`dataset/`**: 保存模型训练所用的数据集
- **`aug_results`**: 保存可视化数据集经数据增强后得到的结果


## 进度

1. **文献调研：**
   - 2024/10/07
   - 调研目标检测/目标分割相关模型，完成研究背景的主要内容
   - 完成项目立项书中对应的子项目部分撰写
   - 调研内容：引用条目见`references_list`文档，出于版权原因原文pdf没有作为本仓库的附件
   - 调研结果：关于目标检测的详细背景见项目立项书；由于近年来目标分割技术快速发展，以SAM为代表的目标分割技术在目标检测领域也展现出良好效果，相关技术一并纳入调研范围。
2. **配置yolov5环境，验证算法可行性与可靠性**
   - 2024/10/14
   - 使用anaconda配置yolov5对应版本`pytorch`，`cuda`
   - 调用yolov5预训练模型`yolov5m.pt`对预设类进行处理，效果良好
   - 调用yolov5预训练模型`yolov5m.pt`对贻贝图像进行处理，效果极差，经排查得出原因为yolov5预训练数据集中不包含贻贝类别
   - 拟定采用yolov11算法，利用海底生物数据集训练模型
3. **配置yolov11环境，验证算法可行性与可靠性**
   - 2024/10/21
   - 使用conda配置yolov11对应版本`ultralytics`, `pytorch`，`cuda`
   - 调用yolov11预训练模型`yolo11n.pt`，使用COCO数据集进行试验训练，在短时间内完成`data = "coco8.yaml", epochs = 100,  imgsz = 640`参数下训练，对数据集已有类别识别效果良好
4. **准备贻贝数据集-1**
   - 2024/10/28
   - 在各数据集网站上使用 `贝壳`（中）, `shell`（英）, `conch`（英）等关键词查找数据集
   - 查找结果：
      - 国内网站：现有类似数据集几乎全部在kaggle网站上搜索得到。大部分为贝壳分类数据集及通过鲍鱼贝壳识别其判断其重要农业特征及农业价值数据集。
      - 国外网站：搜索结果与国内网站类似，暂无匹配良好的数据集，可能由于缺少相关数据库或者关键词不当；在尝试下载数据集时出现了网络连接报错，没能解决。
   - 在使用国内现有数据集后，由于数据集的清晰度相比于样本图片有较大差别，个人认为即使存在比较符合需求的数据集，训练得到的模型也不能很好地完成本任务；计划自行标注数据，获得数据集。
5. **准备贻贝数据集-2**
   - 2024/11/4
   - 使用anaconda配置labelimg。安装成功后鼠标点击labelimg就会出现数据类型报错，并且强制退出界面。经过排查后原因为python8.X.X环境问题。使用anaconda配置python9.X.X环境后解决报错。
   - 使用labelimg手动标注。手动标注500+贝壳。由于视频源模糊以及视频拼贴为二维图像后更加模糊（尤其是在视频源中对应帧较少的周边区域），其余区域贝壳人眼难以识别。
   - 询问学长后得知T-Rex Label能够实现相似物体自动标注。大大提高了标注效率。T-Rex Label能够识别一次或多次框选的一类物体，自动标注同类，可惜无法将读入的原有标记作为自动标记的prompt。物体边界区域大量贝壳无法自动标注，考虑放弃将该部分作为数据集。
6. **准备贻贝数据集-3 训练YOLOv11n模型-1**
   - 2024/11/11
   - 由于数据量对于目标检测任务依旧很小，在学长的建议下了解了数据增强技术。数据增强技术能够将训练集中的图片和标注作各种裁切、对称等等操作后得到新的训练集图片和标注，能够在数据集小的情况下大大扩充数据集。
   - 学习了专用于数据增强的Python库 `albumentations`，利用该库完成数据增强任务，代码存放于 `object_detection_data_aug.py`。
   - 得到训练集（test）约1500张图片，验证集（val）约500张图片。
   - 训练过程中多次出现memoryError，只能通过不断缩小 `batch` 值使训练能够完整进行；`batch=4`时能够完成训练。（其他主要参数：`imgsz = 640`, `epochs = 10`）
   - 训练效果不理想。向学长和同组成员请教后发现可能是因为训练集每张图片对应的标注过多。

   

## 贡献与交流

本项目属于团队合作项目，欢迎团队成员对不同任务模块进行补充、改进或提出新的研究思路。如果对当前任务有任何建议或需要交流，请通过以下方式联系本人：

- 姓名： 龚厚霖
- 联系邮箱：[gonghoulin@sjtu.edu.cn]
- 微信：gonghoulin-123

如果你想了解其他子项目：请查看github我们仓库中的其它分支

